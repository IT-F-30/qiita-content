---
title: Asterisk×ガラケーで家の電話を純正アプリから送受信したい！！
tags:
  - asterisk
private: false
updated_at: '2025-12-28T06:14:11+09:00'
id: 8231c91b50061f75d62e
organization_url_name: null
slide: false
ignorePublish: false
---
## 皆さんは家電話を何で受けていますか？

一般のというかとりあえず家に家電があるという方は普通のPanasonicやPioneerのものがとりあえずあるという形だと思います。
私も家の電話は代々PanasonicのFax機能付きのモデルを使っていました。
### ん？そもそも家に電話がないって？ケータイで十分だって？
### ロマンが足りないですね〜
私も半分いらないな〜って思いながらも維持しているのですが、私よりも家族の人間が家の電話がないと友人や親戚と連絡が取りにくいということなので維持しています。
それとほぼ同じ理由で家族の人間が仕事で使うのでFax機能も維持しています。

### ただぁ！
### 家の電話って家でしか送受信できないんですよ

普通に考えて出先で電話を受けられないって不便ですよね？
出先からも電話かけたいし受けたいですよね？

#### ではどうしましょうか？
## 家の電話にAsteriskを導入してスマホから家の電話を送受信できるようにしましょう！
### 皆さんの家の電話はどこから来ていますか？
ほとんどの人はNTTの設備、HGWなどからRJ11(電話線)を使ってPanasonicの電話機に繋がっていると思います。
私の家でもRX-600KIが光ファイバーから光電話という形で電話回線を収容しています。
#### ほとんどの人がRXシリーズから光電話から変換で電話設備に繋がっていると思います。
というかもうNTTはメタルのみの[公衆交換電話網（PSTN）](https://www.ntt-west.co.jp/denwa/2035denwa/)での固定電話サービスの提供を終了し今後はIP回線を利用した回線へと変わっていきます。
では単純にIP電話をAsteriskに収容してみましょう
#### 電話設定→内線設定 からIP電話の設定を始めましょう！!
![RX-600KI](https://raw.githubusercontent.com/IT-F-30/qiita-content/main/image/RX-600KI.png)
このメニューまできたら
- 内線番号(任意)
- ニックネーム(任意)
- 端末属性(任意)
- MACアドレス(AsteriskサーバのMACアドレス)
- ダイジェスト認証(行う)
- ユーザID(Astersikのpjsip.confに書かれたもの)
- パスワード(Astersikのpjsip.confに書かれたもの)

を書いて**設定**をクリックすればOKです。

#### かなり簡単じゃないですか？

これくらいの設定ならやってみたいと思いませんか？

## Asteriskの設定内容の紹介
順番が前後しましたがAsteriskの設定を紹介します。
これは一例なので実際にやるときはIPアドレスの設定を変更してください

### pjsip.conf
```
; -------------------------------------------------------------
; --- HGW (ひかり電話) トランク設定 ---
; -------------------------------------------------------------
[hgw-registration]
type=registration
transport=simpletrans
outbound_auth=hgw-auth
server_uri=sip:192.168.0.1
client_uri=sip:4@192.168.0.1
retry_interval=60

[hgw]
type=endpoint
transport=simpletrans
context=from-hgw
disallow=all
allow=ulaw
outbound_auth=hgw-auth
aors=hgw-aor
direct_media=no
from_user=4
from_domain=192.168.0.1
dtmf_mode=inband
fax_detect=yes

[hgw-auth]
type=auth
auth_type=userpass
password=6000
username=6000

[hgw-aor]
type=aor
contact=sip:192.168.0.1:5060

[hgw-identify]
type=identify
endpoint=hgw
match=192.168.0.1
```
HGW(RX-500KI)のIPアドレスは`192.168.0.1`なのでここをご自分のHGWのIPアドレスに変更してください
### これでほぼ設定は完了です、もうAstersikに家の電話の外線から着信があればAsteriskに入ってきているはずです

## メインストーリー:スマホで家の電話の送受信を行う
### まずは家の電話との接続方法
Asteriskのサーバとはクライアントアプリ(Zoiper)などを使えばLAN内であれば接続できますが、LAN内というのは不便だと思います。
#### そこでTailscaleを使うことを推奨します
TailscaleとはP2Pを基本としたVPNで、通信を許可している機器同士で簡単にNATを超えた通信ができます。

それを利用してスマホとAsteriskサーバ(Ubuntu)のどちらにもインストールしてTailscale経由でAsteriskサーバに接続されます。
これでLTEでもLANでもどこでもインターネットに繋がりさえすればOKとなりましたがもう一つ問題があります。
#### バッテリー持ちです
Zoiperなどのクライアントアプリを常時起動またはバックグラウンドで起動させないと着信を受けられません
これは**携帯電話**としては致命的であり改善させる必要があります。

## エンドコンテンツ:他端末で家の電話の送受信を行う
前述からスマホでの送受信は行えたけれどバッテリー持ちがネックとなってしまったという結論になってしまったと思います。
### では別端末にまとめてしまえば良いのではないでしょうか？
![黒電話(バブリースタイル)](https://raw.githubusercontent.com/IT-F-30/qiita-content/main/image/Black-Phone.jpeg)
上の写真は某中間合宿LTで発表した携帯電話を再現したものですが一応計算上は10時間ぐらいバッテリ持ちはするので使えなくもないです。

### ただぁ！
### ちょっと逸般人要素が強すぎて使いにく
皆さん、考えてみてください
電車でマナーモードではない状態で友達から着信が来て赤面したという経験はありませんか？
それがバカデカいガチのベルでの呼び出し音で鳴るんです。
ちょっと近づきたくないというか同じ車両に居たくないですよね？

発信も同じです。
ちょっと電話かけようと思い、路地裏に入ったら先に黒電話を片手持ちしてダイアルを回してる人が居たら、普通は逃げたくなりませんか？何なら警察に連絡されるかもしれません

### 家の電話を頑張って持ち出したいということが目標ですが
頑張って(警察に通報される可能性も厭わない)は頑張りすぎな気がします

#### 良い落とし所を探していきましょう
### そこでガラケーはいかがでしょうか？

### 皆さんはガラケー(ガラパゴス化した携帯電話機)をご存知ですか？
> 日本では自国のフィーチャーフォンに対して「ガラパゴス化した携帯電話機」という意味でガラケーという俗称がある。
[wikipedia引用](https://ja.wikipedia.org/wiki/%E3%83%95%E3%82%A3%E3%83%BC%E3%83%81%E3%83%A3%E3%83%BC%E3%83%95%E3%82%A9%E3%83%B3)

という~~酷い~~俗称で呼ばれていたガラケーですが割と今も~~しぶとく~~生き残っています。

### 現代版ガラケー(ガラホ)とは
> スマートフォン用のOSや半導体部品を転用して（一部を除く）開発された、日本国内向けフィーチャーフォン（いわゆるガラパゴスケータイ）の一種を指す新造語
[wikipedia引用](https://ja.wikipedia.org/wiki/%E3%82%AC%E3%83%A9%E3%83%9B)

であり4Gなどに対応した最新のガラケーをガラホというらしいです。
**※まどろっこしいのでこの記事では「ガラケー」で統一します**

## ガラケーで純正電話アプリからの送受信を行う

### 端末選定をしよう

ガラケーでかつtailscaleを使うとなるともはや無理では？みたいなと思いますが実はあるんです。
### Androidを搭載さしたガラホがある

#### 実はAndroidを搭載したガラホという私たちみたいなニッチな層にブッ刺さりそうな端末があるんです

au GRATINA KYF42という端末ですが、これは京セラが開発した端末で4G回線に対応して端子はなんとUSB-Cなんです。素晴らしい

これで端末問題はクリアしました、

### ガラホ改造の具体的な手順

#### 必要なアプリ
- QuickShortcutMaker
- tailscale

この二つのアプリをapk経由でUSBから注入します。

#### QuickShortcutMakerの設定
指定したアプリの裏設定を簡単に表示させられる便利アプリです。
これを使って純正電話アプリにSIPサーバの設定を突っ込めばTailscale経由でAsteriskの電話を送受信できるんじゃないか？という目論見です。


![QuickShortcutMakerの設定画像](https://raw.githubusercontent.com/IT-F-30/qiita-content/main/image/QuickShortcutMaker.jpeg)
インクリメンタル検索から「通話アカウント」の設定を開きます。お気に入り設定しとくと便利です

